'use strict';

/*
* <%= entity %> Controller
* Created by ??? on ???...
*/

var Boom = require('boom'),
    Joi = require('joi');

exports.findAll = {
    tags: ['api'],
    auth: false,
    handler: function (request, reply) {
        // 전체 조회
        <%= cap_entity %>.find()
            .exec(function (err, <%= entity %>) {
                // 결과
                if (err) {
                    return reply(Boom.badImplementation(err));
                }
                reply(<%= entity %>);
        });
    }
};

// find data
exports.find = {
    tags: ['api'],
    validate: {
        params: {
            <%= entity %>Id: Joi.string().required()
        }
    },
    auth: false,
    handler: function (request, reply) {
        // 조회
        <%= cap_entity %>.findOne({id: request.params.<%= entity %>Id})
            .exec(function (err, <%= entity %>) {
                // 결과
                if (err) {
                    return reply(Boom.badImplementation(err));
                }
                reply(<%= entity %>);
        });
    }
};

// create new data
exports.create = {
    tags: ['api'],
    validate: {
        payload: {
            attr1: Joi.string().required(),
            attr2: Joi.string().required()
        }
    },
    auth: false,
    handler: function (request, reply) {
        // 생성
        <%= cap_entity %>.create(request.payload)
            .exec(function (err, <%= entity %>) {
                // 결과
                if (err) {
                    return reply(Boom.badImplementation(err));
                }
                reply(<%= entity %>);
        });
    }
};

// update data
exports.update = {
    tags: ['api'],
    validate: {
        params: {
            <%= entity %>Id: Joi.string().required()
        },
        payload: {
            attr1: Joi.string().required(),
            attr2: Joi.string().required()
        }
    },
    auth: false,
    handler: function (request, reply) {
        // 수정
        <%= cap_entity %>.update({id: request.params.<%= entity %>Id}, request.payload)
            .exec(function (err, <%= entity %>) {
                // 결과
                if (err) {
                    return reply(Boom.badImplementation(err));
                }
                reply(<%= entity %>);
            });
    }
};

// delete data
exports.destroy = {
    tags: ['api'],
    validate: {
        params: {
            <%= entity %>Id: Joi.string().required()
        }
    },
    auth: false,
    handler: function (request, reply) {
        // 삭제
        <%= cap_entity %>.destroy({id: request.params.<%= entity %>Id})
            .exec(function (err) {
                // 결과
                if (err) {
                    return reply(Boom.badImplementation(err));
                }
                reply('destroy');
            });
    }
};